- name: parser meta data
  parser_metadata:
    version: 1.0
    # Suggestion
    module: nxos_l2_interface
    network_os: nxos

- name: "template interfaces to network_config.module.nxos_l2_interface as list"
  export: yes
  export_as: list
  extend: network_config.module
  loop: "{{ network_config.nxos.interfaces }}"
  register: nxos_l2_interface
  json_template:
    template:
      - key: name
        value: "{{ item.name }}"
      - key: mode
        value: "{{ item.mode }}"
      - key: native_vlan
        value: "{{ item.switchport.native_vlan }}"
      - key: trunk_allowed_vlans
        value: "{{ item.switchport.trunk_allowed_vlan.split(',') }}"
      - key: access_vlan
        value: "{{ item.switchport.access_vlan }}"
